<html lang="en">

<head>
    <title>DDI Validator</title>
    <style>
        .paddedDiv {
            margin: 20px
        }
    </style>
</head>

<body>
    <div style="font-size:20px; padding:5px">
        <h1>DDI Validator</h1>
        <div style="display:flex">
            <div style="flex-direction:column">
                <div class="paddedDiv">
                    <h2>Input DDI</h2>
                    <label for="inputFileSelector">Select a file containing DDI to validate.</label>
                </div>
                <div class="paddedDiv">
                    <input id="inputFileSelector" type="file" />
                </div>
                <div class="paddedDiv">
                    <h2>DDI profile</h2>
                    Change DDI Profile used for validation
                </div>
                <div id="validatorOutput" class="paddedDiv"></div>
                <div class="paddedDiv" style="display:flex;flex-direction:row">
                    <select id="profileVersion">
                        <option value="ddi32">DDI 3.2</option>
                        <option value="ddi25">DDI 2.5</option>
                    </select>
                    <div style="margin-left:20px" id="validateFileContainer"></div>
                </div>
            </div>
        </div>

        <script>

            const profile25 = "<?xml version='1.0' encoding='UTF-8'?><!--____________________________________________________________________________________Copyright: 2020 CESSDA Metadata OfficeAuthor: Darren Bell - UK Data ArchiveCreated: 2019-10-02Version: v0.31Change summary: Inserted <pr:Instuction> elements related to bitbucket issues #10,#11,#12at https://bitbucket.org/cessda/cessda.cmv/issuesLast modified 2020-06-05 Darren Bell____________________________________________________________________________________--><pr:DDIProfile xmlns:r='ddi:reusable:3_2' xmlns:xhtml='http://www.w3.org/1999/xhtml'    xmlns:pr='ddi:ddiprofile:3_2' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'    xsi:schemaLocation='ddi:ddiprofile:3_2 https://ddialliance.org/Specification/DDI-Lifecycle/3.2/XMLSchema/ddiprofile.xsd'    versionDate='2020-03-06'>    <r:Agency>CESSDA</r:Agency>    <r:ID>CDC_DDI25_PROFILE</r:ID>    <r:Version>0.31</r:Version>    <r:VersionResponsibility>Darren Bell - UKDA</r:VersionResponsibility>    <pr:DDIProfileName>        <r:String>CESSDA DATA CATALOGUE (CDC) DDI2.5 PROFILE</r:String>    </pr:DDIProfileName>    <pr:XPathVersion>1.0</pr:XPathVersion>    <pr:DDINamespace>2.5</pr:DDINamespace>    <pr:XMLPrefixMap>        <pr:XMLPrefix/>        <pr:XMLNamespace>ddi:codebook:2_5</pr:XMLNamespace>    </pr:XMLPrefixMap>    <pr:XMLPrefixMap>        <pr:XMLPrefix>xsi</pr:XMLPrefix>        <pr:XMLNamespace>http://www.w3.org/2001/XMLSchema-instance</pr:XMLNamespace>    </pr:XMLPrefixMap>    <!--****************************************************************************************-->    <!--ROOT ELEMENT-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/@xml:lang' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: ISO 639-1 codes must be used</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/@xsi:schemaLocation'        defaultValue='ddi:codebook:2_5 http://www.ddialliance.org/Specification/DDI-Codebook/2.5/XMLSchema/codebook.xsd'        fixedValue='true' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: System-required information - always 'ddi:codebook:2_5                codebook.xsd'</r:Content>        </r:Description>    </pr:Used>    <!--****************************************************************************************-->    <!--TITLE AND IDENTIFIERS-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/docDscr/citation/titlStmt/titl' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: No</r:Content>            <r:Content>Usage: Title of the CDC XML document</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/docDscr/citation/titlStmt/titl/@xml:lang' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the study title. ISO 639-1 codes must be used.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/docDscr/citation/holdings/@xml:lang' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the study description page at the SP website (there can be                multiple 'holding' elements for study description pages in different languages. ISO                639-1 codes must be used.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/docDscr/citation/holdings/@URI' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: This is the document the metadata refers to, i.e. the URL of the study                description page at the SP website.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/citation/titlStmt/titl' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: No</r:Content>            <r:Content>Usage: Title of the Study. If additional titles are required in other                languages, use the parTitl element</r:Content>            <r:Content>CDC UI Label: Study title</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/citation/titlStmt/titl/@xml:lang' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the study title. ISO 639-1 codes must be used.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/citation/titlStmt/parTitl' isRequired='false'>        <r:Description>            <r:Content>Required: Optional</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: Title of the Study in additional languages other than the 'titl'                element. It is preferable to include this element to hold an English version of the                title if the 'titl' element is not in English.</r:Content>            <r:Content>CDC UI Label: Study title</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<OptionalNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/citation/titlStmt/parTitl/@xml:lang' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if 'parTitl' element is present</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the translated study title. ISO 639-1 codes must                used.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/citation/titlStmt/IDNo' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: The content of this element serves two purposes. First it is used for                the study/archival number given by the SP and secondly it is used for the PID. These                two cases have different specifications. IDNo in the sense of study number is                mandatory. An additional IDNo element may be provided for the purposes of a PID but                it is not mandatory. </r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/citation/titlStmt/IDNo/@xml:lang' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the persistent identifier of the study. ISO 639-1 codes                must be used. @xml:lang is mandatory if the 'IDNo' element is being used to display                a PID but it is not mandatory when IDNo is used to display the Study                Number.</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/citation/titlStmt/IDNo/@agency' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if 'IDNo' is present</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Agency responsible for the identifier of the study.</r:Content>        </r:Description>    </pr:Used>    <!--****************************************************************************************-->    <!--PRINCIPAL INVESTIGATOR / CREATOR-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/stdyDscr/citation/rspStmt/AuthEnty' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: Principal investigator Person OR Institution</r:Content>            <r:Content>CDC UI Label: Creator</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/citation/rspStmt/AuthEnty/@xml:lang' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if 'AuthEnty' element is present</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of Person or Organisation name. ISO 639-1 codes must be                used.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/citation/rspStmt/AuthEnty/@affiliation' isRequired='false'>        <r:Description>            <r:Content>Required: Optional</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: If AuthEnty is a person, the organisational affiliation of that                person</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<OptionalNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <!--****************************************************************************************-->    <!--PUBLISHER-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/stdyDscr/citation/distStmt/distrbtr' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: The element should contain the name of the organisation who has                published the metadata for the harvested study description. This is usually the                SP.</r:Content>            <r:Content>CDC UI Label: Publisher</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/citation/distStmt/distrbtr/@xml:lang' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the organisation name. ISO 639-1 codes must be                used.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/citation/distStmt/distrbtr/@abbr' isRequired='false'>        <r:Description>            <r:Content>Required: Optional</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Abbreviated form of the Publisher name e.g. 'UKDA' for 'UK Data                Archive'</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<OptionalNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>    </pr:Used>    <!--****************************************************************************************-->    <!--YEAR OF PUBLICATION-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/stdyDscr/citation/distStmt/distDate' isRequired='false'>        <r:Description>            <r:Content>Required: Optional</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: The year or freetext date of when the study description was                published</r:Content>            <r:Content>CDC UI Label: Year of publication</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<OptionalNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/citation/distStmt/distDate/@date' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if 'distDate' element is present</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Ideally 'YYYY-MM-DDThh:mm:ssZ' format, but can accept 'YYYY-MM-DD',                'YYYY-MM' or 'YYYY' as date format.</r:Content>            <r:Content>CDC UI Label: Year of publication</r:Content>        </r:Description>    </pr:Used>    <!--****************************************************************************************-->    <!--SUBJECTS AND KEYWORDS-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/subject/keyword' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: Keyword for the study in the local language. There should always be an                English version of the keyword.</r:Content>            <r:Content>CDC UI Label: Keyword</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/subject/keyword/@xml:lang' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if 'keyword' element is present</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the keyword. ISO 639-1 codes must be used.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/subject/keyword/@vocab' defaultValue='ELSST'        fixedValue='true' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if 'keyword' element is present</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Source of keywords - always ELSST</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/subject/keyword/@vocabURI' isRequired='false'>        <r:Description>            <r:Content>Required: Optional</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: For future use when ELSST has migrated to new linked data platform                (late 2020)</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<OptionalNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/subject/topcClas' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: Subject classifcation term for the study in the local language. Use                values from https://vocabularies.cessda.eu/urn/urn:ddi:int.cessda.cv:TopicClassification.                There should always be a value for the English Topic Classification.</r:Content>            <r:Content>CDC UI Label: Topic</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/subject/topcClas/@xml:lang' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if 'topcClas' element is present</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the subject classification term. ISO 639-1 codes must be                used.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/subject/topcClas/@vocab'        defaultValue='CESSDA Topic Classification' fixedValue='true' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: name of the vocabulary. Use 'CESSDA Topic Classification' regardless                of language.</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>        </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/subject/topcClas/@vocabURI' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: The Canonical URN of the CV version that is being used e.g.                'urn:ddi:int.cessda.cv:TopicClassification:4.0' </r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>    </pr:Used>    <!--****************************************************************************************-->    <!--ABSTRACT-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/abstract' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: The abstract for the study</r:Content>            <r:Content>CDC UI Label: Abstract</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/abstract/@xml:lang' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the abstract. ISO 639-1 codes must be used.</r:Content>        </r:Description>    </pr:Used>    <!--****************************************************************************************-->    <!--DATA COLLECTION DATE(S)-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/sumDscr/collDate' isRequired='false'>        <r:Description>            <r:Content>Required: Optional</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: This is the free text expression of the collection period.</r:Content>            <r:Content>CDC UI Label: Data collection period</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<OptionalNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/sumDscr/collDate/@xml:lang' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if collDate element is present and populated</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the free text expression of the collection period. ISO                639-1 codes must be used.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/sumDscr/collDate/@event' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if @date Attribute is present</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Either 'start', 'end' or 'single' to indicate the type of @date                Attribute</r:Content>            <r:Content>CDC UI Label: Data collection period: start date OR Data collection period:                End date</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/sumDscr/collDate/@date' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if 'collDate' element is present and empty</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Ideally YYYY-MM-DDThh:mm:ssZ format , but can accept YYYY-MM-DD,                YYYY-MM or YYYY as date attribute. If there are multiple end dates, use the                last.</r:Content>        </r:Description>    </pr:Used>    <!--****************************************************************************************-->    <!--COUNTRY COVERAGE-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/sumDscr/nation' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: Countries relevant to the study area</r:Content>            <r:Content>CDC UI Label: Country</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/sumDscr/nation/@xml:lang' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if 'nation' element is present</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the country label. ISO 639-1 codes must be                used.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/sumDscr/nation/@abbr' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: ISO 3166-1 2-letter code must be used if this attribute is                present</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <!--****************************************************************************************-->    <!--ANALYSIS UNIT-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/sumDscr/anlyUnit' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: Contains the Analysis Unit CV item in the local language.</r:Content>            <r:Content>CDC UI Label: Analysis unit</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/sumDscr/anlyUnit/@xml:lang' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if 'anlyUnit' element is present</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the Analysis Unit CV item. ISO 639-1 codes must be                used.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/sumDscr/anlyUnit/concept' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: No</r:Content>            <r:Content>Analysis Unit Controlled Vocabulary 'Code value' that is the same across                languages. e.g if the 'anlyUnit' element is 'Kotitalous' for Finnish, the 'concept'                element is 'Household' See                https://vocabularies.cessda.eu/urn/urn:ddi:int.ddi.cv:AnalysisUnit.</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/sumDscr/anlyUnit/concept/@vocab'        defaultValue='DDI Analysis Unit' fixedValue='true' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Use the string 'DDI Analysis Unit' regardless of language.</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/stdyInfo/sumDscr/anlyUnit/concept/@vocabURI'        isRequired='false'>        <r:Description>            <r:Content>Required: Optional</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: The Canonical URN of the CV version that is being used e.g.                'urn:ddi:int.ddi.cv:AnalysisUnit:2.0' </r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<OptionalNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <!--****************************************************************************************-->    <!--TIME DIMENSION-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/timeMeth' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: Contains the Time Method CV item in the local language</r:Content>            <r:Content>CDC UI Label: Time dimension</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/timeMeth/@xml:lang' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if 'timeMeth' element is present</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the Time Method CV item. ISO 639-1 codes must be                used.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/timeMeth/concept' isRequired='false'>        <r:Description>            <r:Content>Recommended</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: No</r:Content>            <r:Content>Usage: Time Method Controlled Vocabulary 'Code value' that is the same across                languages. e.g if the 'timeMeth' element is 'Pitkittäisaineisto' for Finnish, the                'concept' element is 'Longitudinal' See                https://vocabularies.cessda.eu/urn/urn:ddi:int.ddi.cv:TimeMethod</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/timeMeth/concept/@vocab'        defaultValue='DDI Time Method' fixedValue='true' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Use the string 'DDI Time Method' regardless of language.</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/timeMeth/concept/@vocabURI'        defaultValue='urn:ddi-cv:TimeMethod' fixedValue='false' isRequired='false'>        <r:Description>            <r:Content>Required: Optional</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: The Canonical URN of the CV version that is being used e.g.                'urn:ddi:int.ddi.cv:TimeMethod:1.2'</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<OptionalNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <!--****************************************************************************************-->    <!--SAMPLING METHOD / PROCEDURE-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/sampProc' isRequired='false'>        <r:Description>            <r:Content>Required: Optional</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: Contains the Sampling Procedure CV item in the local language OR a                freetext description in the local language</r:Content>            <r:Content>CDC UI Label: Sampling procedure</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<OptionalNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/sampProc/@xml:lang' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if 'sampProc' element is present</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the Sampling Procedure CV item or freetext description.                ISO 639-1 codes must be used.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/sampProc/concept' isRequired='false'>        <r:Description>            <r:Content>Recommended</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: No</r:Content>            <r:Content>Usage: Sampling Procedure Controlled Vocabulary 'Code value' that is the same                across languages. e.g if the 'sampProc' element is 'Todennäköisyysotanta' for                Finnish, the 'concept' element is 'Probability' See                https://vocabularies.cessda.eu/urn/urn:ddi:int.ddi.cv:SamplingProcedure </r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/sampProc/concept/@vocab'        defaultValue='DDI Sampling Procedure' fixedValue='true' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Use the string 'DDI Sampling Procedure' regardless of                language.</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>        </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/sampProc/concept/@vocabURI'        isRequired='false'>        <r:Description>            <r:Content>Required: Optional</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: The Canonical URN of the CV version that is being used e.g.                'urn:ddi:int.ddi.cv:SamplingProcedure:1.1'</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<OptionalNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <!--****************************************************************************************-->    <!--DATA COLLECTION METHOD-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/collMode' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: Contains the Mode of Collection CV item in the local                language.</r:Content>            <r:Content>CDC UI Label: Data collection method</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/collMode/@xml:lang' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if 'collMode' element is present</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the Mode of Collection CV item. ISO 639-1 codes must be                used.</r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/collMode/concept' isRequired='false'>        <r:Description>            <r:Content>Recommended</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: No</r:Content>            <r:Content>Usage: Mode of Collection Controlled Vocabulary 'Code value' that is the same                across languages. e.g if the 'collMode' element is 'Haastattelu' for Finnish, the                'concept' element is 'Interview' See                https://vocabularies.cessda.eu/urn/urn:ddi:int.ddi.cv:ModeOfCollection </r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/collMode/concept/@vocab'        defaultValue='DDI Mode of Collection' fixedValue='true' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Use the string 'DDI Mode of Collection' regardless of                language.</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/method/dataColl/collMode/concept/@vocabURI'        isRequired='false'>        <r:Description>            <r:Content>Required: Optional</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: The Canonical URN of the CV version that is being used e.g.                'urn:ddi:int.ddi.cv:ModeOfCollection:3.0'</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<OptionalNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>            </pr:Used>    <!--****************************************************************************************-->    <!--ACCESS STATEMENT-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/stdyDscr/dataAccs/useStmt/restrctn' isRequired='false'>        <r:Description>            <r:Content>Required: Recommended</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: Refers to any information relating to the access and use conditions of                data that the SP wants to send. SPs need to concatenate the information for                'restrctn' the way they want it to appear in the CDC, if they use data from                different elements e.g.specPerm, restrctn, avlStatus etc. </r:Content>            <r:Content>CDC UI Label: Terms of data access</r:Content>        </r:Description>        <pr:Instructions>            <r:Content><![CDATA[			<Constraints>				<RecommendedNodeConstraint/>			</Constraints>			]]></r:Content>        </pr:Instructions>       </pr:Used>    <pr:Used xpath='/codeBook/stdyDscr/dataAccs/useStmt/restrctn/@xml:lang' isRequired='false'>        <r:Description>            <r:Content>Required: Mandatory if 'restrctn' is present</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language of the Access statement. ISO 639-1 codes must be                used.</r:Content>        </r:Description>    </pr:Used>    <!--****************************************************************************************-->    <!--FILE DESCRIPTIONS-->    <!--****************************************************************************************-->    <pr:Used xpath='/codeBook/fileDscr/fileTxt/fileName' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Content element</r:Content>            <r:Content>ElementRepeatable: Yes</r:Content>            <r:Content>Usage: Language-specific name of file </r:Content>        </r:Description>    </pr:Used>    <pr:Used xpath='/codeBook/fileDscr/fileTxt/fileName/@xml:lang' isRequired='true'>        <r:Description>            <r:Content>Required: Mandatory</r:Content>            <r:Content>ElementType: Attribute</r:Content>            <r:Content>Usage: Language(s) of data files. The only information necessary for CDC is                the language of the files, as this is needed for the filter. The values or content                of 'fileName' are not extracted. ISO 639-1 codes must be used. </r:Content>            <r:Content>CDC UI Label: Language of data file(s).</r:Content>        </r:Description>    </pr:Used></pr:DDIProfile>"

            const profile32 = "<?xml version='1.0' encoding='UTF-8'?><?xml-stylesheet href='DDI32Profile2html.xslt' type='text/xsl'?><pr:DDIProfile xmlns:pr='ddi:ddiprofile:3_2' xmlns:r='ddi:reusable:3_2' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:schemaLocation='ddi:instance:3_2 http://www.ddialliance.org/Specification/DDI-Lifecycle/3.2/XMLSchema/instance.xsd'>  <r:URN>urn:ddi:xx.agencyid:objectid:1</r:URN>  <pr:DDIProfileName>    <r:String>CLOSER Dataset DDI-Lifecycle 3.2 Profile</r:String>  </pr:DDIProfileName>  <r:Label>    <r:Content>CLOSER DDI Lifecycle 3.2 Profile for a Dataset</r:Content>  </r:Label>  <r:Description>    <r:Content>Describes DDI Lifecycle 3.2 items that are expected for ingest into CLOSER Discovery</r:Content>  </r:Description>  <pr:ApplicationOfProfile>Allows checking of inputs to ensure that all expeced content has been generated by the SPSS or Stata to DDI conversion tools. </pr:ApplicationOfProfile>  <r:Purpose>    <r:Content>Allows providers and CLOSER to assess the content of datasets generated for ingest into CLOSER Discovery</r:Content>  </r:Purpose>  <pr:XPathVersion>1.0</pr:XPathVersion>  <pr:DDINamespace>3.2</pr:DDINamespace>  <pr:XMLPrefixMap>    <pr:XMLPrefix/>    <pr:XMLNamespace>ddi:instance:3_2</pr:XMLNamespace>  </pr:XMLPrefixMap>  <pr:XMLPrefixMap>    <pr:XMLPrefix>r</pr:XMLPrefix>    <pr:XMLNamespace>ddi:reusable:3_2</pr:XMLNamespace>  </pr:XMLPrefixMap>  <pr:XMLPrefixMap>    <pr:XMLPrefix>g</pr:XMLPrefix>    <pr:XMLNamespace>ddi:group:3_2</pr:XMLNamespace>  </pr:XMLPrefixMap>  <pr:XMLPrefixMap>    <pr:XMLPrefix>ddi</pr:XMLPrefix>    <pr:XMLNamespace>ddi:logicalproduct:3_2</pr:XMLNamespace>  </pr:XMLPrefixMap>  <pr:XMLPrefixMap>    <pr:XMLPrefix>p</pr:XMLPrefix>    <pr:XMLNamespace>ddi:physicaldataproduct:3_2</pr:XMLNamespace>  </pr:XMLPrefixMap>  <pr:XMLPrefixMap>    <pr:XMLPrefix>ddi1</pr:XMLPrefix>    <pr:XMLNamespace>ddi:physicaldataproduct_proprietary:3_2</pr:XMLNamespace>  </pr:XMLPrefixMap>  <pr:XMLPrefixMap>    <pr:XMLPrefix>pi</pr:XMLPrefix>    <pr:XMLNamespace>ddi:physicalinstance:3_2</pr:XMLNamespace>  </pr:XMLPrefixMap>  <!-- Element 'Used': Adjust the attributes isRequired and fixedValue (currently set to default values). Additionally, the attributes 'defaultValue' and 'limitMaxOccurs' are possible.-->  <pr:Used xpath='/DDIInstance' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/r:URN' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/r:Citation' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/r:Citation/r:Title' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/r:Citation/r:Title/r:String' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/r:Citation/r:AlternateTitle' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:LogicalProduct' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:LogicalProduct/ddi:LogicalProductName' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:LogicalProduct/r:Label' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:LogicalProduct/r:Label/r:Content' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:LogicalProduct/ddi:DataRelationship' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:LogicalProduct/ddi:DataRelationship/ddi:DataRelationshipName' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:LogicalProduct/ddi:DataRelationship/ddi:LogicalRecord' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:LogicalProduct/ddi:DataRelationship/ddi:LogicalRecord/ddi:LogicalRecordName' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:LogicalProduct/ddi:DataRelationship/ddi:LogicalRecord/ddi:VariablesInRecord' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:LogicalProduct/ddi:DataRelationship/ddi:LogicalRecord/ddi:VariablesInRecord/ddi:VariableUsedReference' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:LogicalProduct/ddi:DataRelationship/ddi:LogicalRecord/ddi:VariablesInRecord/ddi:VariableUsedReference/r:TypeOfObject' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:LogicalProduct/r:CategorySchemeReference' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:LogicalProduct/r:CodeListSchemeReference' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:LogicalProduct/r:VariableSchemeReference' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:PhysicalDataProductName' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:PhysicalStructureScheme' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:PhysicalStructureScheme/p:PhysicalStructure' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:PhysicalStructureScheme/p:PhysicalStructure/r:BasedOnObject' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:PhysicalStructureScheme/p:PhysicalStructure/r:BasedOnObject/r:BasedOnReference' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:PhysicalStructureScheme/p:PhysicalStructure/p:FileFormat' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:PhysicalStructureScheme/p:PhysicalStructure/p:GrossRecordStructure' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:PhysicalStructureScheme/p:PhysicalStructure/p:GrossRecordStructure/p:LogicalRecordReference' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:PhysicalStructureScheme/p:PhysicalStructure/p:GrossRecordStructure/p:PhysicalRecordSegment' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:PhysicalStructureScheme/p:PhysicalStructure/p:GrossRecordStructure/p:PhysicalRecordSegment/r:Agency' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:PhysicalStructureScheme/p:PhysicalStructure/p:GrossRecordStructure/p:PhysicalRecordSegment/r:ID' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:PhysicalStructureScheme/p:PhysicalStructure/p:GrossRecordStructure/p:PhysicalRecordSegment/r:Version' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout/p:PhysicalStructureLinkReference' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout/p:PhysicalStructureLinkReference/p:PhysicalRecordSegmentUsed' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout/ddi1:SystemSoftware' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout/ddi1:SystemSoftware/r:SoftwareName' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout/ddi1:SystemSoftware/r:Description' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout/r:DefaultVariableSchemeReference' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout/r:ProprietaryInfo' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout/r:ProprietaryInfo/r:ProprietaryProperty' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout/r:ProprietaryInfo/r:ProprietaryProperty/r:AttributeKey' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout/r:ProprietaryInfo/r:ProprietaryProperty/r:AttributeValue' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout/ddi1:DataItem' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout/ddi1:DataItem/r:VariableReference' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout/ddi1:DataItem/ddi1:ProprietaryDataType' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/p:PhysicalDataProduct/p:RecordLayoutScheme/ddi1:RecordLayout/ddi1:DataItem/ddi1:ProprietaryOutputFormat' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/r:RecordLayoutReference' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:DataFileIdentification' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:DataFileIdentification/pi:DataFileURI' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:GrossFileStructure' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:GrossFileStructure/pi:CreationSoftware' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:GrossFileStructure/pi:CaseQuantity' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:SummaryStatistic' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:SummaryStatistic/pi:TypeOfSummaryStatistic' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:SummaryStatistic/pi:Statistic' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:UnfilteredCategoryStatistics' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:UnfilteredCategoryStatistics/pi:VariableCategory' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:UnfilteredCategoryStatistics/pi:VariableCategory/pi:CategoryValue' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:UnfilteredCategoryStatistics/pi:VariableCategory/pi:CategoryValue/r:Value' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:UnfilteredCategoryStatistics/pi:VariableCategory/pi:CategoryStatistic' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:UnfilteredCategoryStatistics/pi:VariableCategory/pi:CategoryStatistic/pi:TypeOfCategoryStatistic' fixedValue='Minimum' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:UnfilteredCategoryStatistics/pi:VariableCategory/pi:CategoryStatistic/pi:TypeOfCategoryStatistic' fixedValue='Maximum' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:UnfilteredCategoryStatistics/pi:VariableCategory/pi:CategoryStatistic/pi:TypeOfCategoryStatistic' fixedValue='Mean' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:UnfilteredCategoryStatistics/pi:VariableCategory/pi:CategoryStatistic/pi:TypeOfCategoryStatistic' fixedValue='ValidCases' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:UnfilteredCategoryStatistics/pi:VariableCategory/pi:CategoryStatistic/pi:TypeOfCategoryStatistic' fixedValue='InvalidCases' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:UnfilteredCategoryStatistics/pi:VariableCategory/pi:CategoryStatistic/pi:TypeOfCategoryStatistic' fixedValue='Mode' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:UnfilteredCategoryStatistics/pi:VariableCategory/pi:CategoryStatistic/pi:TypeOfCategoryStatistic' fixedValue='Frequency' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/pi:PhysicalInstance/pi:StatisticalSummary/pi:VariableStatistics/pi:UnfilteredCategoryStatistics/pi:VariableCategory/pi:CategoryStatistic/pi:TypeOfCategoryStatistic' fixedValue='InvalidCases' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:CategoryScheme' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:CategoryScheme/ddi:CategorySchemeName' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:CategoryScheme/ddi:Category' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:CodeListScheme' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:CodeListScheme/ddi:CodeList' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:CodeListScheme/ddi:CodeList/ddi:CodeListName' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:CodeListScheme/ddi:CodeList/ddi:Code' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:CodeListScheme/ddi:CodeList/ddi:Code/r:CategoryReference' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:VariableScheme' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:VariableScheme/ddi:VariableSchemeName' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:VariableScheme/ddi:Variable' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:VariableScheme/ddi:Variable/ddi:VariableName' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:VariableScheme/ddi:Variable/ddi:VariableRepresentation' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:VariableScheme/ddi:Variable/ddi:VariableRepresentation/r:TextRepresentation' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:VariableScheme/ddi:Variable/ddi:VariableRepresentation/r:TextRepresentation/r:RecommendedDataType' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:VariableScheme/ddi:Variable/ddi:VariableRepresentation/r:TextRepresentation/r:GenericOutputFormat' fixedValue='false' isRequired='false'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:VariableScheme/ddi:Variable/ddi:VariableRepresentation/r:CodeRepresentation' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:VariableScheme/ddi:Variable/ddi:VariableRepresentation/r:CodeRepresentation/r:CodeListReference' fixedValue='false' isRequired='true'/>  <pr:Used xpath='/DDIInstance/g:ResourcePackage/ddi:VariableScheme/ddi:Variable/ddi:VariableRepresentation/r:NumericRepresentation' fixedValue='false' isRequired='false'/></pr:DDIProfile>"

            var profile = profile32;

            var fileList;

            const selectElement = document.querySelector("#profileVersion");

            const result = document.querySelector(".result");

            selectElement.addEventListener("change", (event) => {

                switch (event.target.value) {
                    case 'ddi32':
                        profile = profile32;
                        break;
                    case 'ddi25':
                        profile = profile25;
                        break;
                    default:
                        profile = profile32;
                }

                setInputToValidator()
            });

            async function executePostRequestWithoutToken(url, requestBody) {

                const options = {
                    method: 'POST',
                    body: JSON.stringify(requestBody),
                    headers: { 'Content-Type': 'application/json' }

                }

                try {
                    const res = fetch(url, options);
                    return await res;
                } catch (error) {
                    document.getElementById("validatorOutput").innerHTML = (`Error: API call to ${url} failed! ${error}`)
                }

            }

            const inputFileElement = document.getElementById("inputFileSelector");

            inputFileElement.addEventListener("change", addValidateButton, false);


            function addValidateButton() {

                fileList = this.files;

                setInputToValidator()

                const validateFileButtonDiv = document.getElementById("validateFileContainer");

                const validateFileButtonObject = document.createElement("button");

                validateFileButtonObject.textContent = "Validate"

                validateFileButtonObject.setAttribute('aria-label', 'Validate uploaded files')

                validateFileButtonObject.addEventListener("click", () => validateDdi(), false)

                validateFileButtonDiv.innerHTML = ""

                validateFileButtonDiv.appendChild(validateFileButtonObject)

            }


            var jsonBodyTemplate = {
                "document": {
                    "content": "string"
                },
                "profile": {
                    "content": profile
                },
                "validationGateName": "BASIC",

            }


            function setInputToValidator() {

                const reader = new FileReader()
                
                reader.readAsArrayBuffer(fileList[0])
                
                reader.onload = (function (event) {
                    jsonBodyTemplate.profile.content = profile
                    jsonBodyTemplate.document.content = new TextDecoder().decode(reader.result)
                })

            }

            function validateDdi() {
                const cessdaValidationServiceURL = "https://cmv.cessda.eu/api/V0/Validation"
                
                executePostRequestWithoutToken(cessdaValidationServiceURL,
                    jsonBodyTemplate
                ).then(apiResponse => {
                    var output
                    switch (apiResponse.status) {

                        case 200:
                            return apiResponse.json()
                            break;
                        case 400:
                            output = `The following input to the CESSDA DDI validation REST API was rejected
                        as being invalid:
                        ${JSON.stringify(jsonBodyTemplate)}`
                            break
                        case 404:
                            output = `Could not find DDI validation service at ${cessdaValidationServiceURL}`
                            break
                        default:
                            output = "Error validating selected input file. Please check you are uploading a file containing DDI content."
                            break
                    }
                    document.getElementById("validatorOutput").innerHTML = output

                }
                ).then(apiResponse => {
                    var output;
                    output = "<div>"
                    output = output + apiResponse.ConstraintViolation.map(
                        violation => "<div>" + violation.message + "</div>").join("")
                    output = output + "</div>"
                    
                    document.getElementById("validatorOutput").innerHTML = output
                }

                )
            }

        </script>

</body>

</html>